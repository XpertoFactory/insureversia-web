---
import { t, getLocalePath, type Locale } from '../i18n';

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;
const p = (path: string) => getLocalePath(locale, path);
const year = new Date().getFullYear();
---

<footer class="site-footer">
  <div class="container">
    <div class="grid grid--4" style="margin-bottom: var(--space-12);">
      <!-- Brand -->
      <div>
        <p style="font-family: var(--font-heading); font-size: var(--text-2xl); font-weight: var(--font-extrabold); margin-bottom: var(--space-3);">
          Insureversia<span style="color: var(--color-secondary);">.</span>
        </p>
        <p style="color: rgba(255,255,255,0.7); font-size: var(--text-sm); margin-bottom: var(--space-4);">
          {t(locale, 'footer.tagline')}
        </p>
        <p style="font-family: var(--font-accent); font-style: italic; color: var(--color-secondary); font-size: var(--text-lg);">
          "{t(locale, 'site.tagline')}"
        </p>
      </div>

      <!-- Explore + Learn -->
      <div>
        <h4 style="color: var(--color-secondary); font-size: var(--text-sm); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-4);">{t(locale, 'footer.explore')}</h4>
        <ul style="list-style: none; padding: 0;">
          <li style="margin-bottom: var(--space-2);"><a href={p('/explore/new-frontiers/')} style="font-size: var(--text-sm);">{t(locale, 'nav.newFrontiers')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/explore/ai-impact/')} style="font-size: var(--text-sm);">{t(locale, 'nav.aiImpact')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/explore/challenges/')} style="font-size: var(--text-sm);">{t(locale, 'nav.challenges')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/practice/applications/')} style="font-size: var(--text-sm);">{t(locale, 'nav.applications')}</a></li>
        </ul>

        <h4 style="color: var(--color-secondary); font-size: var(--text-sm); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-4); margin-top: var(--space-6);">{t(locale, 'footer.learn')}</h4>
        <ul style="list-style: none; padding: 0;">
          <li style="margin-bottom: var(--space-2);"><a href={p('/learn/ai-101/')} style="font-size: var(--text-sm);">{t(locale, 'nav.ai101')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/learn/what-to-do/')} style="font-size: var(--text-sm);">{t(locale, 'nav.whatToDo')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/learn/what-not-to-do/')} style="font-size: var(--text-sm);">{t(locale, 'nav.whatNotToDo')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/learn/prompt-engineering/')} style="font-size: var(--text-sm);">{t(locale, 'nav.promptEngineering')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/learn/program/')} style="font-size: var(--text-sm);">{t(locale, 'nav.learningProgram')}</a></li>
        </ul>
      </div>

      <!-- Practice + Resources -->
      <div>
        <h4 style="color: var(--color-secondary); font-size: var(--text-sm); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-4);">{t(locale, 'footer.practice')}</h4>
        <ul style="list-style: none; padding: 0;">
          <li style="margin-bottom: var(--space-2);"><a href={p('/practice/quick-wins/')} style="font-size: var(--text-sm);">{t(locale, 'nav.quickWins')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/practice/prompt-library/')} style="font-size: var(--text-sm);">{t(locale, 'nav.promptLibrary')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/practice/ethics-simulator/')} style="font-size: var(--text-sm);">{t(locale, 'nav.ethicsSimulator')}</a></li>
        </ul>

        <h4 style="color: var(--color-secondary); font-size: var(--text-sm); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-4); margin-top: var(--space-6);">{t(locale, 'footer.resources')}</h4>
        <ul style="list-style: none; padding: 0;">
          <li style="margin-bottom: var(--space-2);"><a href={p('/resources/faq/')} style="font-size: var(--text-sm);">{t(locale, 'nav.faq')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/resources/glossary/')} style="font-size: var(--text-sm);">{t(locale, 'nav.glossary')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/resources/tool-directory/')} style="font-size: var(--text-sm);">{t(locale, 'nav.toolDirectory')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/resources/jurisdiction-guide/')} style="font-size: var(--text-sm);">{t(locale, 'nav.jurisdictionGuide')}</a></li>
          <li style="margin-bottom: var(--space-2);"><a href={p('/about/')} style="font-size: var(--text-sm);">{t(locale, 'nav.about')}</a></li>
        </ul>
      </div>

      <!-- Newsletter -->
      <div>
        <h4 style="color: var(--color-secondary); font-size: var(--text-sm); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: var(--space-4);">{t(locale, 'footer.newsletter')}</h4>
        <p style="color: rgba(255,255,255,0.7); font-size: var(--text-sm); margin-bottom: var(--space-4);">
          {t(locale, 'footer.newsletterDesc')}
        </p>
        <form class="flex gap-2" onsubmit="return false;">
          <input
            type="email"
            id="newsletter-email"
            name="email"
            placeholder={t(locale, 'footer.emailPlaceholder')}
            style="flex: 1; padding: var(--space-2) var(--space-3); border: 1px solid rgba(255,255,255,0.2); border-radius: var(--radius-md); background: rgba(255,255,255,0.1); color: var(--text-inverse); font-size: var(--text-sm);"
          />
          <button type="submit" class="btn btn--primary btn--sm">{t(locale, 'footer.subscribe')}</button>
        </form>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: var(--space-6);">
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:var(--space-4);">
        <p style="color: rgba(255,255,255,0.5); font-size: var(--text-sm); margin: 0;">
          &copy; {year} {t(locale, 'footer.copyright')}
        </p>
        <div style="display:flex;align-items:center;gap:var(--space-3);">
          <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme flavor" title="Switch theme flavor">
            <span class="theme-toggle__label" id="theme-toggle-label">Modern</span>
          </button>
          <button class="theme-toggle" id="mode-toggle" aria-label="Toggle dark mode" title="Switch light/dark mode">
            <svg id="mode-icon-sun" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;">
              <circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
            </svg>
            <svg id="mode-icon-moon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
          </button>
          <p style="color: rgba(255,255,255,0.4); font-size: var(--text-xs); margin: 0; max-width: 500px;">
            {t(locale, 'footer.disclaimer')}
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<style>
  .theme-toggle {
    display: inline-flex;
    align-items: center;
    padding: 4px 10px;
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    background: transparent;
    border: 1.5px solid rgba(255,255,255,0.25);
    border-radius: var(--radius-sm);
    color: rgba(255,255,255,0.5);
    cursor: pointer;
    transition: all 150ms ease;
    white-space: nowrap;
  }
  .theme-toggle:hover {
    border-color: var(--color-secondary);
    color: var(--color-secondary);
  }
</style>

<script>
  // === Theme flavor toggle (Classic / Modern) ===
  const themeToggle = document.getElementById('theme-toggle');
  const themeLabel = document.getElementById('theme-toggle-label');

  function updateThemeLabel() {
    const isModern = document.documentElement.dataset.theme === 'modern';
    if (themeLabel) themeLabel.textContent = isModern ? 'Classic' : 'Modern';
  }

  updateThemeLabel();

  themeToggle?.addEventListener('click', () => {
    const isModern = document.documentElement.dataset.theme === 'modern';
    if (isModern) {
      delete document.documentElement.dataset.theme;
      localStorage.setItem('insureversia-theme', 'classic');
    } else {
      document.documentElement.dataset.theme = 'modern';
      localStorage.setItem('insureversia-theme', 'modern');
    }
    updateThemeLabel();
  });

  // === Dark/Light mode toggle ===
  const modeToggle = document.getElementById('mode-toggle');
  const sunIcon = document.getElementById('mode-icon-sun');
  const moonIcon = document.getElementById('mode-icon-moon');

  function updateModeIcon() {
    const isDark = document.documentElement.dataset.mode === 'dark';
    if (sunIcon) sunIcon.style.display = isDark ? 'block' : 'none';
    if (moonIcon) moonIcon.style.display = isDark ? 'none' : 'block';
  }

  updateModeIcon();

  modeToggle?.addEventListener('click', () => {
    const isDark = document.documentElement.dataset.mode === 'dark';
    if (isDark) {
      delete document.documentElement.dataset.mode;
      localStorage.setItem('insureversia-mode', 'light');
    } else {
      document.documentElement.dataset.mode = 'dark';
      localStorage.setItem('insureversia-mode', 'dark');
    }
    updateModeIcon();
  });
</script>
